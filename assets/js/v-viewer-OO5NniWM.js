import{V as $}from"./viewerjs-BV9ZP1np.js";import{h as R,r as q,w as T,n as M,d as gt,a as mt,o as ht,b as jt,e as wt,f as Ot,g as _t}from"./@vue-NjRJHK3Q.js";var $t=typeof global=="object"&&global&&global.Object===Object&&global;const tt=$t;var At=typeof self=="object"&&self&&self.Object===Object&&self,xt=tt||At||Function("return this")();const E=xt;var Tt=E.Symbol;const S=Tt;var et=Object.prototype,Mt=et.hasOwnProperty,St=et.toString,O=S?S.toStringTag:void 0;function Vt(t){var e=Mt.call(t,O),r=t[O];try{t[O]=void 0;var n=!0}catch{}var o=St.call(t);return n&&(e?t[O]=r:delete t[O]),o}var Et=Object.prototype,Pt=Et.toString;function Dt(t){return Pt.call(t)}var Ut="[object Null]",Ft="[object Undefined]",N=S?S.toStringTag:void 0;function P(t){return t==null?t===void 0?Ft:Ut:N&&N in Object(t)?Vt(t):Dt(t)}function D(t){return t!=null&&typeof t=="object"}var It="[object Symbol]";function Ct(t){return typeof t=="symbol"||D(t)&&P(t)==It}var kt=Array.isArray;const Bt=kt;var Wt=/\s/;function Lt(t){for(var e=t.length;e--&&Wt.test(t.charAt(e)););return e}var Rt=/^\s+/;function qt(t){return t&&t.slice(0,Lt(t)+1).replace(Rt,"")}function g(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var z=NaN,Nt=/^[-+]0x[0-9a-f]+$/i,zt=/^0b[01]+$/i,Ht=/^0o[0-7]+$/i,Gt=parseInt;function H(t){if(typeof t=="number")return t;if(Ct(t))return z;if(g(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=g(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=qt(t);var r=zt.test(t);return r||Ht.test(t)?Gt(t.slice(2),r?2:8):Nt.test(t)?z:+t}function rt(t){return t}var Jt="[object AsyncFunction]",Kt="[object Function]",Qt="[object GeneratorFunction]",Xt="[object Proxy]";function nt(t){if(!g(t))return!1;var e=P(t);return e==Kt||e==Qt||e==Jt||e==Xt}var Yt=E["__core-js_shared__"];const I=Yt;var G=function(){var t=/[^.]+$/.exec(I&&I.keys&&I.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Zt(t){return!!G&&G in t}var te=Function.prototype,ee=te.toString;function re(t){if(t!=null){try{return ee.call(t)}catch{}try{return t+""}catch{}}return""}var ne=/[\\^$.*+?()[\]{}|]/g,oe=/^\[object .+?Constructor\]$/,ie=Function.prototype,ue=Object.prototype,ae=ie.toString,ce=ue.hasOwnProperty,fe=RegExp("^"+ae.call(ce).replace(ne,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function se(t){if(!g(t)||Zt(t))return!1;var e=nt(t)?fe:oe;return e.test(re(t))}function le(t,e){return t==null?void 0:t[e]}function ve(t,e){var r=le(t,e);return se(r)?r:void 0}function de(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}var pe=800,be=16,ye=Date.now;function ge(t){var e=0,r=0;return function(){var n=ye(),o=be-(n-r);if(r=n,o>0){if(++e>=pe)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function me(t){return function(){return t}}var he=function(){try{var t=ve(Object,"defineProperty");return t({},"",{}),t}catch{}}();const V=he;var je=V?function(t,e){return V(t,"toString",{configurable:!0,enumerable:!1,value:me(e),writable:!0})}:rt;const we=je;var Oe=ge(we);const _e=Oe;var $e=9007199254740991,Ae=/^(?:0|[1-9]\d*)$/;function ot(t,e){var r=typeof t;return e=e??$e,!!e&&(r=="number"||r!="symbol"&&Ae.test(t))&&t>-1&&t%1==0&&t<e}function it(t,e,r){e=="__proto__"&&V?V(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}function B(t,e){return t===e||t!==t&&e!==e}var xe=Object.prototype,Te=xe.hasOwnProperty;function ut(t,e,r){var n=t[e];(!(Te.call(t,e)&&B(n,r))||r===void 0&&!(e in t))&&it(t,e,r)}function Me(t,e,r,n){var o=!r;r||(r={});for(var c=-1,f=e.length;++c<f;){var u=e[c],v=void 0;v===void 0&&(v=t[u]),o?it(r,u,v):ut(r,u,v)}return r}var J=Math.max;function Se(t,e,r){return e=J(e===void 0?t.length-1:e,0),function(){for(var n=arguments,o=-1,c=J(n.length-e,0),f=Array(c);++o<c;)f[o]=n[e+o];o=-1;for(var u=Array(e+1);++o<e;)u[o]=n[o];return u[e]=r(f),de(t,this,u)}}function at(t,e){return _e(Se(t,e,rt),t+"")}var Ve=9007199254740991;function ct(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=Ve}function U(t){return t!=null&&ct(t.length)&&!nt(t)}function ft(t,e,r){if(!g(r))return!1;var n=typeof e;return(n=="number"?U(r)&&ot(e,r.length):n=="string"&&e in r)?B(r[e],t):!1}function Ee(t){return at(function(e,r){var n=-1,o=r.length,c=o>1?r[o-1]:void 0,f=o>2?r[2]:void 0;for(c=t.length>3&&typeof c=="function"?(o--,c):void 0,f&&ft(r[0],r[1],f)&&(c=o<3?void 0:c,o=1),e=Object(e);++n<o;){var u=r[n];u&&t(e,u,n,c)}return e})}var Pe=Object.prototype;function W(t){var e=t&&t.constructor,r=typeof e=="function"&&e.prototype||Pe;return t===r}function De(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}var Ue="[object Arguments]";function K(t){return D(t)&&P(t)==Ue}var st=Object.prototype,Fe=st.hasOwnProperty,Ie=st.propertyIsEnumerable,Ce=K(function(){return arguments}())?K:function(t){return D(t)&&Fe.call(t,"callee")&&!Ie.call(t,"callee")};const ke=Ce;function Be(){return!1}var lt=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Q=lt&&typeof module=="object"&&module&&!module.nodeType&&module,We=Q&&Q.exports===lt,X=We?E.Buffer:void 0,Le=X?X.isBuffer:void 0,Re=Le||Be;const qe=Re;var Ne="[object Arguments]",ze="[object Array]",He="[object Boolean]",Ge="[object Date]",Je="[object Error]",Ke="[object Function]",Qe="[object Map]",Xe="[object Number]",Ye="[object Object]",Ze="[object RegExp]",tr="[object Set]",er="[object String]",rr="[object WeakMap]",nr="[object ArrayBuffer]",or="[object DataView]",ir="[object Float32Array]",ur="[object Float64Array]",ar="[object Int8Array]",cr="[object Int16Array]",fr="[object Int32Array]",sr="[object Uint8Array]",lr="[object Uint8ClampedArray]",vr="[object Uint16Array]",dr="[object Uint32Array]",s={};s[ir]=s[ur]=s[ar]=s[cr]=s[fr]=s[sr]=s[lr]=s[vr]=s[dr]=!0;s[Ne]=s[ze]=s[nr]=s[He]=s[or]=s[Ge]=s[Je]=s[Ke]=s[Qe]=s[Xe]=s[Ye]=s[Ze]=s[tr]=s[er]=s[rr]=!1;function pr(t){return D(t)&&ct(t.length)&&!!s[P(t)]}function br(t){return function(e){return t(e)}}var vt=typeof exports=="object"&&exports&&!exports.nodeType&&exports,_=vt&&typeof module=="object"&&module&&!module.nodeType&&module,yr=_&&_.exports===vt,C=yr&&tt.process,gr=function(){try{var t=_&&_.require&&_.require("util").types;return t||C&&C.binding&&C.binding("util")}catch{}}();const Y=gr;var Z=Y&&Y.isTypedArray,mr=Z?br(Z):pr;const hr=mr;var jr=Object.prototype,wr=jr.hasOwnProperty;function dt(t,e){var r=Bt(t),n=!r&&ke(t),o=!r&&!n&&qe(t),c=!r&&!n&&!o&&hr(t),f=r||n||o||c,u=f?De(t.length,String):[],v=u.length;for(var a in t)(e||wr.call(t,a))&&!(f&&(a=="length"||o&&(a=="offset"||a=="parent")||c&&(a=="buffer"||a=="byteLength"||a=="byteOffset")||ot(a,v)))&&u.push(a);return u}function Or(t,e){return function(r){return t(e(r))}}var _r=Or(Object.keys,Object);const $r=_r;var Ar=Object.prototype,xr=Ar.hasOwnProperty;function Tr(t){if(!W(t))return $r(t);var e=[];for(var r in Object(t))xr.call(t,r)&&r!="constructor"&&e.push(r);return e}function Mr(t){return U(t)?dt(t):Tr(t)}var Sr=Object.prototype,Vr=Sr.hasOwnProperty,Er=Ee(function(t,e){if(W(e)||U(e)){Me(e,Mr(e),t);return}for(var r in e)Vr.call(e,r)&&ut(t,r,e[r])});const Pr=Er;function Dr(t){var e=[];if(t!=null)for(var r in Object(t))e.push(r);return e}var Ur=Object.prototype,Fr=Ur.hasOwnProperty;function Ir(t){if(!g(t))return Dr(t);var e=W(t),r=[];for(var n in t)n=="constructor"&&(e||!Fr.call(t,n))||r.push(n);return r}function Cr(t){return U(t)?dt(t,!0):Ir(t)}var kr=function(){return E.Date.now()};const k=kr;var Br="Expected a function",Wr=Math.max,Lr=Math.min;function Rr(t,e,r){var n,o,c,f,u,v,a=0,i=!1,l=!1,p=!0;if(typeof t!="function")throw new TypeError(Br);e=H(e)||0,g(r)&&(i=!!r.leading,l="maxWait"in r,c=l?Wr(H(r.maxWait)||0,e):c,p="trailing"in r?!!r.trailing:p);function b(d){var y=n,w=o;return n=o=void 0,a=d,f=t.apply(w,y),f}function m(d){return a=d,u=setTimeout(h,e),i?b(d):f}function j(d){var y=d-v,w=d-a,L=e-y;return l?Lr(L,c-w):L}function A(d){var y=d-v,w=d-a;return v===void 0||y>=e||y<0||l&&w>=c}function h(){var d=k();if(A(d))return x(d);u=setTimeout(h,j(d))}function x(d){return u=void 0,p&&n?b(d):(n=o=void 0,f)}function bt(){u!==void 0&&clearTimeout(u),a=0,n=v=o=u=void 0}function yt(){return u===void 0?f:x(k())}function F(){var d=k(),y=A(d);if(n=arguments,o=this,v=d,y){if(u===void 0)return m(v);if(l)return clearTimeout(u),u=setTimeout(h,e),b(v)}return u===void 0&&(u=setTimeout(h,e)),f}return F.cancel=bt,F.flush=yt,F}var pt=Object.prototype,qr=pt.hasOwnProperty,Nr=at(function(t,e){t=Object(t);var r=-1,n=e.length,o=n>2?e[2]:void 0;for(o&&ft(e[0],e[1],o)&&(n=1);++r<n;)for(var c=e[r],f=Cr(c),u=-1,v=f.length;++u<v;){var a=f[u],i=t[a];(i===void 0||B(i,pt[a])&&!qr.call(t,a))&&(t[a]=c[a])}return t});const zr=Nr,Hr=({images:t=[],options:e})=>{e=Pr(e,{inline:!1});const r=document.createElement("div"),n=R("div",{style:{display:"none"},class:["__viewer-token"]},t.map(u=>R("img",typeof u=="string"?{src:u}:u)));q(n,r);const o=r.firstElementChild;document.body.appendChild(o);const c=new $(o,e),f=c.destroy.bind(c);return c.destroy=function(){return f(),q(null,r),c},c.show(),o.addEventListener("hidden",function(){this.viewer===c&&c.destroy()}),c},Gr=({name:t="viewer",debug:e=!1}={})=>{async function r(i,l,p=!1,b=!1){await M(),!(b&&!n(i))&&(p||!i[`$${t}`]?(f(i),i[`$${t}`]=new $(i,l),a("Viewer created")):(i[`$${t}`].update(),a("Viewer updated")))}function n(i){const l=i.innerHTML.match(/<img([\w\W]+?)[\\/]?>/g),p=l?l.join(""):void 0;return i.__viewerImageDiffCache===p?(a("Element change detected, but image(s) has not changed"),!1):(a("Image change detected"),i.__viewerImageDiffCache=p,!0)}function o(i,l,p,b){u(i);const m=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;if(!m){a("Observer not supported");return}const j=new m(h=>{h.forEach(x=>{a(`Viewer mutation:${x.type}`),p(i,l,b,!0)})}),A={attributes:!0,childList:!0,characterData:!0,subtree:!0};j.observe(i,A),i.__viewerMutationObserver=j,a("Observer created")}function c(i,l,p,b){i.__viewerUnwatch=T(()=>l.value,(m,j)=>{a("Change detected by watcher: ",l.value),b(i,m,!0,!1)},{deep:!0}),a("Watcher created, expression: ",l.value)}function f(i){!i[`$${t}`]||(i[`$${t}`].destroy(),delete i[`$${t}`],a("Viewer destroyed"))}function u(i){!i.__viewerMutationObserver||(i.__viewerMutationObserver.disconnect(),delete i.__viewerMutationObserver,a("observer destroyed"))}function v(i){!i.__viewerUnwatch||(i.__viewerUnwatch(),delete i.__viewerUnwatch,a("Watcher destroyed"))}function a(...i){e&&console.log(...i)}return{mounted(i,l,p){a("Viewer bind");const b=Rr(r,50);b(i,l.value),c(i,l,p,b),l.modifiers.static||o(i,l.value,b,l.modifiers.rebuild)},unmounted(i){a("Viewer unbind"),u(i),v(i),f(i)}}},Jr=gt({name:"Viewer",props:{images:{type:Array,default:()=>[]},rebuild:{type:Boolean,default:!1},trigger:{type:Object,default:null},options:{type:Object,default:()=>null}},emits:["inited"],setup(t,{emit:e}){let r;const n=wt();function o(){r=new $(n.value,t.options),e("inited",r)}function c(){r&&r.destroy()}function f(){c(),o()}function u(){r?(r.update(),e("inited",r)):o()}function v(){t.rebuild?f():u()}const a={deep:!0};return T(()=>t.images,()=>{M(()=>{v()})},a),T(()=>t.trigger,()=>{M(()=>{v()})},a),T(()=>t.options,()=>{M(()=>{f()})},a),Ot(()=>o()),_t(()=>c()),{root:n,createViewer:o,rebuildViewer:f,updateViewer:u,destroyViewer:c}}}),Kr=(t,e)=>{const r=t.__vccOpts||t;for(const[n,o]of e)r[n]=o;return r},Qr={ref:"root"};function Xr(t,e,r,n,o,c){return ht(),mt("div",Qr,[jt(t.$slots,"default",{images:t.images,options:t.options})],512)}const Yr=Kr(Jr,[["render",Xr]]),en={install(t,{name:e="viewer",debug:r=!1,defaultOptions:n}={}){n&&$.setDefaults(n),t.config.globalProperties[`$${e}Api`]=Hr,t.component(e,zr(Yr,{name:e})),t.directive(e,Gr({name:e,debug:r}))},setDefaults(t){$.setDefaults(t)}};export{en as r};
